require(nortest)
escitalopram=read.csv2("/Users/helder/Helder1/Trabalhos/Production/Pain/escitalopram_hp.csv")
#ad.karol_res_vpa=ad.test(array(karol_res_vpa[,1],dim=c(10,6)))
attach(escitalopram)
aov.est0=aov(T0~Treat)
tuk.est0=TukeyHSD(aov(T0~Treat))
aov.est30=aov(T30~Treat)
tuk.est30=TukeyHSD(aov(T30~Treat))
aov.est60=aov(T60~Treat)
tuk.est60=TukeyHSD(aov(T60~Treat))
aov.est90=aov(T90~Treat)
tuk.est90=TukeyHSD(aov(T90~Treat))
aov.est120=aov(T120~Treat)
tuk.est120=TukeyHSD(aov(T120~Treat))
aov.est180=aov(T180~Treat)
tuk.est180=TukeyHSD(aov(T180~Treat))
escit.mean=matrix(cbind(c(tapply(T0,Treat,mean),tapply(T30,Treat,mean),tapply(T60,Treat,mean),tapply(T90,Treat,mean),tapply(T120,Treat,mean),tapply(T180,Treat,mean))),nrow=4)[c(1,2,4,3),]
escit.sd=matrix(cbind(c(tapply(T0,Treat,sd),tapply(T30,Treat,sd),tapply(T60,Treat,sd),tapply(T90,Treat,sd),tapply(T120,Treat,sd),tapply(T180,Treat,sd))),nrow=4)[c(1,2,4,3),]
escit.se=matrix(cbind(c(tapply(T0,Treat,sd),tapply(T30,Treat,sd),tapply(T60,Treat,sd),tapply(T90,Treat,sd),tapply(T120,Treat,sd),tapply(T180,Treat,sd))),nrow=4)[c(1,2,4,3),]/sqrt(7)


plot(matrix(escit.mean,nrow=4)[c(1,2,4,3),][1,],ylim=c(5,18),type="o",bty="n",xaxt="n",xlab="Time after treatment (min)",ylab="Latency (s)")
axis(1,at=1:6,labels=c("0","30","60","90","120","180"))
lines(escit.mean[2,],ylim=c(0,18),type="o",pch=0)
lines(escit.mean[3,],ylim=c(0,18),type="o",pch=2)
lines(escit.mean[4,],ylim=c(0,18),type="o",pch=5)
arrows(c(1,2,3,4,5,6),escit.mean[1,],c(1,2,3,4,5,6),escit.mean[1,]+escit.se[1,],code=2,angle=90,lty=1,lwd=1,length=0.05)
arrows(c(1,2,3,4,5,6),escit.mean[2,],c(1,2,3,4,5,6),escit.mean[2,]+escit.se[2,],code=2,angle=90,lty=1,lwd=1,length=0.05)
arrows(c(1,2,3,4,5,6),escit.mean[3,],c(1,2,3,4,5,6),escit.mean[3,]+escit.se[3,],code=2,angle=90,lty=1,lwd=1,length=0.05)
arrows(c(1,2,3,4,5,6),escit.mean[4,],c(1,2,3,4,5,6),escit.mean[4,]+escit.se[4,],code=2,angle=90,lty=1,lwd=1,length=0.05)
arrows(c(1,2,3,4,5,6),escit.mean[1,],c(1,2,3,4,5,6),escit.mean[1,]-escit.se[1,],code=2,angle=90,lty=1,lwd=1,length=0.05)
arrows(c(1,2,3,4,5,6),escit.mean[2,],c(1,2,3,4,5,6),escit.mean[2,]-escit.se[2,],code=2,angle=90,lty=1,lwd=1,length=0.05)
arrows(c(1,2,3,4,5,6),escit.mean[3,],c(1,2,3,4,5,6),escit.mean[3,]-escit.se[3,],code=2,angle=90,lty=1,lwd=1,length=0.05)
arrows(c(1,2,3,4,5,6),escit.mean[4,],c(1,2,3,4,5,6),escit.mean[4,]-escit.se[4,],code=2,angle=90,lty=1,lwd=1,length=0.05)
points(escit.mean[4,]+1.5,pch=8,col=c(0,1,1,1,1,1))
points(c(0.9,1.9,2.9,3.9,4.9,5.9),escit.mean[4,]+1.5,pch=8,col=c(0,1,1,1,1,1))
points(c(1.1,2.1,3.1,4.1,5.1,6.1),escit.mean[4,]+1.5,pch=8,col=c(0,1,1,1,1,1))
points(escit.mean[3,]+1.5,pch=8,col=c(0,0,1,1,0,0))
dev.copy(postscript,'/Users/helder/Helder1/Trabalhos/Production/Pain/graphs/escitalopram_hp.ps',height=8.5,width=8.5,paper="letter",horiz=F)
dev.off()
dev.copy(jpeg,'/Users/helder/Helder1/Trabalhos/Production/Pain/graphs/escitalopram_hp.jpg',height=600,width=600)
dev.off()
dev.copy(tiff,'/Users/helder/Helder1/Trabalhos/Production/Pain/graphs/escitalopram_hp.tif',height=600,width=600)
dev.off()

par(fg="white",col.axis="white",col.lab="white",cex=1.5)
barplot(escit.mean,beside=T,ylim=c(0,18),axisnames=T,col=c("darkgreen","darkorange1",4,"violetred4"),names.arg=c("0","30","60","90","120","180"),axis.lty=1,legend.text=c("Cont","10","30","100"),args.legend=list(x=8,y=16,bty="n"),xlab="Tempo tratamento (min)",ylab="LatÃªncia (s)")
arrows(c(1.5,6.5,11.5,16.5,21.5,26.5),escit.mean[1,],c(1.5,6.5,11.5,16.5,21.5,26.5),escit.mean[1,]+escit.se[1,],code=2,angle=90,lty=1,lwd=1,length=0.05)
arrows(c(2.5,7.5,12.5,17.5,22.5,27.5),escit.mean[2,],c(2.5,7.5,12.5,17.5,22.5,27.5),escit.mean[2,]+escit.se[2,],code=2,angle=90,lty=1,lwd=1,length=0.05)
arrows(c(3.5,8.5,13.5,18.5,23.5,28.5),escit.mean[3,],c(3.5,8.5,13.5,18.5,23.5,28.5),escit.mean[3,]+escit.se[3,],code=2,angle=90,lty=1,lwd=1,length=0.05)
arrows(c(4.5,9.5,14.5,19.5,24.5,29.5),escit.mean[4,],c(4.5,9.5,14.5,19.5,24.5,29.5),escit.mean[4,]+escit.se[4,],code=2,angle=90,lty=1,lwd=1,length=0.05)
points(x=c(4.5,9.5,14.5,19.5,24.5,29.5)-0.5,escit.mean[4,]+1,pch=8,col=c(0,"white","white","white","white","white"))
points(c(4.5,9.5,14.5,19.5,24.5,29.5),escit.mean[4,]+1,pch=8,col=c(0,"white","white","white","white","white"))
points(c(4.5,9.5,14.5,19.5,24.5,29.5)+0.5,escit.mean[4,]+1,pch=8,col=c(0,"white","white","white","white","white"))
points(c(3.5,8.5,13.5,18.5,23.5,28.5),escit.mean[3,]+1.5,pch=8,col=c(0,0,"white","white",0,0))
dev.copy(postscript,'/Users/helder/Helder1/Trabalhos/Production/Pain/graphs/escitalopram_hp2.ps',height=8.5,width=8.5,paper="letter",horiz=F)
dev.off()
dev.copy(jpeg,'/Users/helder/Helder1/Trabalhos/Production/Pain/graphs/escitalopram_hp2.jpg',height=600,width=900)
dev.off()
dev.copy(tiff,'/Users/helder/Helder1/Trabalhos/Production/Pain/graphs/escitalopram_hp2.tif',height=2400,width=3600,res=300)
dev.off()
